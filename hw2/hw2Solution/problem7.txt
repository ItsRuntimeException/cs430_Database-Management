Script started on Sat 06 Oct 2018 02:53:59 PM EDT
eoneil@pe07:~/630/hw2Solution.f18$ !sq
sqlplus cs630test/cs630test@//dbs3.cs.umb.edu/dbs3;

SQL*Plus: Release 12.1.0.2.0 Production on Sat Oct 6 14:54:04 2018

Copyright (c) 1982, 2014, Oracle.  All rights reserved.

Last Successful login time: Sat Oct 06 2018 14:32:07 -04:00

Connected to:
Oracle Database 12c Enterprise Edition Release 12.1.0.2.0 - 64bit Production
With the Partitioning, OLAP, Advanced Analytics and Real Application Testing options

SQL> set enc  cho on
SQL> @problem7.sql
SQL> -- 1. Print the names and ages of each employee who works in both the Hardware
SQL> -- department and the Software department.
SQL> 
SQL> select e.ename, e.age
  2  from emp e, works w, dept d
  3  where e.eid = w.eid AND w.did = d.did
  4        AND dname = 'Software'
  5  INTERSECT
  6  select e.ename, e.age
  7  from emp e, works w, dept d
  8  where e.eid = w.eid AND w.did = d.did
  9        AND dname = 'Hardware';

ENAME                                 AGE
------------------------------ ----------
Mary Johnson                           44
Stanley Browne                         23

SQL> 
SQL> -- or to avoid INTERSECT:
SQL> select e.ename, e.age from emp e
  2  where e.eid in
  3  (select e.eid
  4  from emp e, works w, dept d
  5  where e.eid = w.eid AND w.did = d.did
  6        AND dname = 'Software')
  7  AND e.eid in
  8  (select e.eid
  9  from emp e, works w, dept d
 10  where e.eid = w.eid AND w.did = d.did
 11        AND dname = 'Hardware');

ENAME                                 AGE
------------------------------ ----------
Mary Johnson                           44
Stanley Browne                         23

SQL> 
SQL> 
SQL> 
SQL> -- 3. Print the name of each employee whose salary exceeds the budget of all
SQL> -- of the departments that he or she works in.
SQL> 
SQL> -- list the budgets for all the departments that employee x works in
SQL> -- select d.budget
SQL> -- from works w, dept d
SQL> -- where w.did = d.did and w.eid = x
SQL> 
SQL> -- put this together with the employees and their salaries
SQL> 
SQL> select e.ename
  2       from emp e
  3  where e.salary >
  4      (select max(d.budget) from works w, dept d
  5        where w.did = d.did AND w.eid = e.eid);

ENAME
------------------------------
Linda Davis

SQL> 
SQL> 
SQL> -- 6. If a manager manages more than one department, he or she controls the sum of all the
SQL> -- budgets for those departments. Find the managerids of managers who control more than
SQL> -- $5 million.
SQL> -- First consider one manager's (x's) total controlled budget
SQL> -- select sum(d.budget) from dept d where d.managerid = x
SQL> 
SQL> select d.managerid from dept d
  2  where 5000000 <
  3   (select sum(d1.budget) from dept d1 where d1.managerid = d.managerid);

 MANAGERID
----------
 578875478

SQL> 
SQL> exit
Disconnected from Oracle Database 12c Enterprise Edition Release 12.1.0.2.0 - 64bit Production
With the Partitioning, OLAP, Advanced Analytics and Real Application Testing options
eoneil@pe07:~/630/hw2Solution.f18$ exit
exit

Script done on Sat 06 Oct 2018 02:54:19 PM EDT
