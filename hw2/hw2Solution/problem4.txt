Script started on Sat 06 Oct 2018 02:44:55 PM EDT
eoneil@pe07:~/630/hw2Solution.f18$ sqlp[K[K[K[K!sq;
sqlplus cs630test/cs630test@//dbs3.cs.umb.edu/dbs3;

SQL*Plus: Release 12.1.0.2.0 Production on Sat Oct 6 14:45:02 2018

Copyright (c) 1982, 2014, Oracle.  All rights reserved.

Last Successful login time: Fri Oct 05 2018 16:57:22 -04:00

Connected to:
Oracle Database 12c Enterprise Edition Release 12.1.0.2.0 - 64bit Production
With the Partitioning, OLAP, Advanced Analytics and Real Application Testing options

SQL> @[rp    set ecjp    jp    ho on
SQL> @problem4.sql
SQL> --CS 630 hw 2 Solutions: Problem 4.3 of R&G
SQL> --Jinghui Zhou     (student name)
SQL> --start up script on topcat or pe07
SQL> --connect to dbs3 using sqlplus
SQL> --use "set echo on", then run this by "@problem4.sql"
SQL> --exit from sqlplus, then exit again to finish typescript
SQL> --"mv typescript problem4.txt" to rename it for delivery
SQL> -- Note: all-caps for SQL keywords is not needed
SQL> -- But we need to capitalize color names in table parts to match data
SQL> --[4.3 part1] Find the names of suppliers who supply some red part.
SQL> SELECT DISTINCT s.sname
  2  FROM suppliers s, parts p, catalog c
  3  
SQL> WHERE p.color='Red' AND c.pid=p.pid AND c.sid=s.sid;
SP2-0734: unknown command beginning "WHERE p.co..." - rest of line ignored.
SQL> 
SQL> --Problem 2
SQL> -- 2. Find the sids of suppliers who supply some red or green part.
SQL> 
SQL> SELECT DISTINCT s.sid FROM suppliers s, catalog c, parts p
  2  where s.sid=c.sid and c.pid=p.pid and (p.color='Red' or p.color='Green');

       SID
----------
         1
         2
         4
         3

SQL> 
SQL> --Problem 3
SQL> -- 3. Find the sids of suppliers who supply some red part or are at 221 Packer
SQL> -- Street.
SQL> 
SQL> SELECT DISTINCT s.sid FROM suppliers s, catalog c, parts p
  2  where s.sid=c.sid and c.pid=p.pid and p.color='Red'
  3  UNION
  4  SELECT DISTINCT s.sid FROM suppliers s
  5  where s.address='221 Packer Ave';

       SID
----------
         1
         2
         3
         4

SQL> 
SQL> --Problem 4
SQL> -- 4. Find the sids of suppliers who supply some red part and some green part.
SQL> 
SQL> SELECT DISTINCT s.sid FROM suppliers s, catalog c, parts p
  2   where s.sid=c.sid and c.pid=p.pid and p.color='Red'
  3   INTERSECT
  4   SELECT DISTINCT s.sid FROM suppliers s, catalog c, parts p
  5   where s.sid=c.sid and c.pid=p.pid and p.color='Green';

       SID
----------
         1
         3

SQL> 
SQL> 
SQL> --Problem 9
SQL> -- 9. Find pairs of sids such that the supplier with the first sid charges
SQL> -- more for some part than the supplier with the second sid.
SQL> 
SQL> SELECT DISTINCT c1.sid, c2.sid from catalog c1, catalog c2
  2  WHERE c1.sid<>c2.sid and c2.pid=c1.pid and c1.cost > c2.cost;

       SID        SID
---------- ----------
         4          1
         1          2
         3          1
         4          2
         1          3
         3          2
         4          3

7 rows selected.

SQL> 
SQL> --Problem 10
SQL> -- 10. Find the pids of parts supplied by at least two different suppliers.
SQL> 
SQL> SELECT DISTINCT c1.pid from catalog c1, catalog c2
  2  WHERE c1.sid!=c2.sid and c2.pid=c1.pid;

       PID
----------
         1
         4
         5
         8
         7
         9

6 rows selected.

SQL> 
SQL> --Problem 11
SQL> -- 11. Find the pids of the most expensive parts supplied by suppliers named
SQL> -- Yosemite Sham.
SQL> SELECT c.pid from catalog c, suppliers s
  2  Where s.sname='Yosemite Sham' and c.sid=s.sid
  3  INTERSECT
  4  Select c1.pid from catalog c1, catalog c2
  5  where c1.pid=c2.pid and c1.pid>c2.pid;

no rows selected

SQL> exit
Disconnected from Oracle Database 12c Enterprise Edition Release 12.1.0.2.0 - 64bit Production
With the Partitioning, OLAP, Advanced Analytics and Real Application Testing options
eoneil@pe07:~/630/hw2Solution.f18$ exit
exit

Script done on Sat 06 Oct 2018 02:45:29 PM EDT
